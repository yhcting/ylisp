(print '"====== Start Testing 'string' =======\n")
(assert (eq 5 (s.length 'abcde)))
(set 'x 10.98)
(assert (eq '10 (s.itos x)))
(assert (eq '10.980000 (s.dtos x)))
(assert (eq 'abcdefgh (s.concat 'ab 'cdef 'gh)))
(set 'lns (s.split-to-line '"123\n\n7890\nabcd"))
(assert (eq '123 (car lns)))
(assert (eq 0 (s.length (cadr lns))))
(assert (eq '7890 (caddr lns)))
(assert (eq 'abcd (car (cdddr lns))))

; test pcre if possible!
(cond ((is-set 's.re-match)
        (let ((R '()))
            (set 'R (s.re-match '"([0-9]+)([a-z]+)\\s" '"  hahah 12abc123abcd effff" '""))
            (assert (eq '"123abcd " (car R)))
            (assert (eq '123 (cadr R)))
            (assert (eq 'abcd (caddr R)))
            (set 'R (s.re-match '"^([0-9]+)([a-z]+)" '"123aBcD fff" '"i"))
            (assert (eq '123aBcD (car R))))))

(cond ((is-set 's.re-replace)
        (let ((R '()) (subj '"hahaha my name is cho!"))
            (set 'R (s.re-replace '"name" '"full name" subj '""))
            (assert (eq R '"hahaha my full name is cho!"))
            (assert (eq '"Abcde abcde ab" (s.re-replace 'a 'A '"abcde abcde ab" '"")))
            (assert (eq '"abcde" (s.re-replace 't 'T '"abcde" '"")))
            (assert (eq '"Abcde Abcde Ab" (s.re-replace 'a 'A '"abcde abcde ab" '"g"))))))

(assert (eq 'a (s.at 'abcdefg 0)))
(assert (eq 'g (s.at 'abcdefg 6)))
(assert (eq 'c (s.at 'abcdefg 2)))

(assert (< (s.compare 'ab 'cd) 0))
(assert (> (s.compare 'cd 'ab) 0))
(assert (= (s.compare 'ab 'ab) 0))

(assert (not (s.end-with 'abc 'abcd)))
(assert (not (s.end-with '"" 'ab)))
(assert (not (s.end-with 'abc '"")))
(assert (not (s.end-with 'abcde 'ed)))
(assert (s.end-with 'abcde 'abcde))
(assert (s.end-with 'abcde 'cde))
(assert (s.end-with 'abcde 'e))

(assert (not (s.start-with 'abc 'abcd)))
(assert (not (s.start-with '"" 'ab)))
(assert (not (s.start-with 'abc '"")))
(assert (not (s.start-with 'abcde 'ed)))
(assert (not (s.start-with 'abcde 'ab 1)))
(assert (not (s.start-with 'abcde 'ab 5)))
(assert (not (s.start-with 'abcde 'b -2))) 
(assert (s.start-with 'abcde 'abcde))
(assert (s.start-with 'abcde 'abc))
(assert (s.start-with 'abcde 'a))
(assert (s.start-with 'abcde 'a 0))
(assert (not (s.start-with 'abcde 'a -1)))
(assert (s.start-with 'abcde 'cd 2))

(assert (eq '() (s.index-of 'abcdeabcde '"")))
(assert (eq '() (s.index-of 'abcdeabcde 'abcdefabcdef)))
(assert (eq '() (s.index-of '"" '"")))
(assert (eq '() (s.index-of '"" 'abc)))
(assert (eq 0 (s.index-of 'abcdeabcde 'a)))
(assert (eq 0 (s.index-of 'abcdeabcde 'abcdeabcde)))
(assert (eq 0 (s.index-of 'abcdeabcde 'abc)))
(assert (eq 2 (s.index-of 'abcdeabcde 'cde)))
(assert (eq '() (s.index-of 'abcdeabcde 'tt)))
(assert (eq 2 (s.index-of 'abcdeabcde 'cd)))
(assert (eq 2 (s.index-of 'abcdeabcde 'cd 2)))
(assert (eq 7 (s.index-of 'abcdeabcde 'cd 3)))
(assert (eq 7 (s.index-of 'abcdeabcde 'cd 7)))
(assert (eq '() (s.index-of 'abcdeabcde 'cd 8)))

(assert (eq '() (s.last-index-of 'abcdeabcde '"")))
(assert (eq '() (s.last-index-of 'abcdeabcde 'abcdefabcdef)))
(assert (eq '() (s.last-index-of '"" '"")))
(assert (eq '() (s.last-index-of '"" 'abc)))
(assert (eq 5 (s.last-index-of 'abcdeabcde 'a)))
(assert (eq 5 (s.last-index-of 'abcdeabcde 'abc)))
(assert (eq 0 (s.last-index-of 'abcdeabcde 'abcdeabcde)))
(assert (eq '() (s.last-index-of 'abcdeabcde 'tt)))
(assert (eq 5 (s.last-index-of 'abcdeabcde 'a 5)))
(assert (eq 0 (s.last-index-of 'abcdeabcde 'a 4)))

(assert (eq '1234512345 (s.replace 'abcdeabcde 'abcde '12345)))
(assert (eq 'abcdeabcde (s.replace 'abcdeabcde '"" '12345)))
(assert (eq 'abcdeabcde (s.replace 'abcdeabcde '"" '"")))
(assert (eq 'dede (s.replace 'abcdeabcde 'abc '"")))
(assert (eq '12345 (s.replace 'abcdeabcde 'abcdeabcde '12345)))

(assert (eq 'abcdeabcde (s.substring 'abcdeabcde 0)))
(assert (eq 'abcdeabcde (s.substring 'abcdeabcde -3)))
(assert (eq 'abcde (s.substring 'abcdeabcde 5)))
(assert (eq '"" (s.substring 'abcdeabcde 100)))
(assert (eq '"" (s.substring 'abcdeabcde 6 3)))
(assert (eq '"" (s.substring 'abcdeabcde 0 0)))
(assert (eq 'a (s.substring 'abcdeabcde 0 1)))
(assert (eq 'e (s.substring 'abcdeabcde 9 10)))
(assert (eq 'cd (s.substring 'abcdeabcde 7 9)))
(assert (eq 'ab (s.substring 'abcdeabcde 0 2)))
(assert (eq 'cde (s.substring 'abcdeabcde 2 5)))

(assert (eq 'abc12de (s.to-lower-case 'abC12De)))
(assert (eq 'ABC12DE (s.to-upper-case 'abC12De)))

(assert (eq 'abc  (s.trim 'abc)))
(assert (eq 'abc  (s.trim '"  abc")))
(assert (eq 'abc  (s.trim '"  abc   ")))
(assert (eq '""  (s.trim '"     ")))

(unset 'x)
(unset 'lns)
